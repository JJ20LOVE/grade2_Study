# 死锁

**死锁发生的必要条件**：互斥条件，不剥夺条件，请求和保持条件，循环等待条件

发生死锁时一定有循环等待，但发生循环等待不一定发生死锁

**死锁的处理策略：**预防死锁，避免死锁，死锁的检测和解除

## 死锁的处理

**破坏互斥条件：**只有对必须互斥使用的资源的争抢才会导致死锁

**破坏不剥夺条件**：进程所获得的资源在未使用完之前，不能让其他进程抢走，只能主动释放

**破坏请求和保持条件**：进程已经保持了至少一个资源，但是又提出了新的资源请求，而该资源又被其它进程占有，它又保持着自己的资源不放，可以采用静态资源分配方法

**破坏循环等待条件**：存在一种进程资源的循环等待链，可采用顺序资源分配法

**银行家算法**

**死锁的检测**

死锁的解除：资源剥夺法，撤销进程法，进程回退法

# 内存

操作系统负责内存空间的分配与回收 提供某种技术对内存进行扩充 负责逻辑地址与物理地址的转换

三种装入方式：绝对装入 可重定位装入 动态装入

**内存保护**

![image-20260103154540066](/Users/miaowu/Library/Application Support/typora-user-images/image-20260103154540066.png)

**连续分配管理**：单一连续分配，固定分区分配（无外部碎片，有内部碎片），动态分区分配（无内部碎片，有外部碎片）

内部碎片：分配给某进程的内存区域中，有些部分没有用上

外部碎片：内存中某些空闲分区由于太小而难以利用

## 动态分区分配算法

### 首次适应算法

每次从地地址查找，找到第一个能满足大小的空闲分区

### 最佳适应算法

优先使用更小的空闲区

会产生很多的外部碎片

### 最坏适应算法

优先使用最大的连续空闲区

### 邻近适应算法

每次都从上次查找的位置开始检索

![image-20260103162203543](/Users/miaowu/Library/Application Support/typora-user-images/image-20260103162203543.png)

## 页表



![image-20260103163854400](/Users/miaowu/Library/Application Support/typora-user-images/image-20260103163854400.png)

基本地址变换机构可以借助进程的页表将逻辑地址转换为物理地址

页表长度：这个页表总共有几个页表项

页表项长度：每个页表项占多大的存储空间

页式管理中地址是一维的

**快表（TLB）**：类似于高速缓存，只有页表项的副本

采用多级页表机制，各级页表的大小不能超过一个页面

**基本分段存储管理**

段号的位数决定了每个进程最多可以分几个段

段内地址位数决定了每个段的最大长度是多少

页是信息的物理行为，对用户是不可见的

段是信息的逻辑单位，对用户是可见的

分段的用户进程地址空间是二维的

![image-20260103192600450](/Users/miaowu/Library/Application Support/typora-user-images/image-20260103192600450.png)

段页式管理



## 虚拟内存

多次性

对换性

虚拟性

请求调页功能，页置换功能

![image-20260103200557125](/Users/miaowu/Library/Application Support/typora-user-images/image-20260103200557125.png)

### 最佳置换算法

每次选择淘汰的页面是以后永不使用或者最长时间内不再使用的页面

### 先进先出置换算法（FIFO）

每次选择淘汰的页面是最早进入内存的页面，会产生Belady异常

### 最近最久未使用置换算法（LRU）

每次淘汰的页面是最近最久未使用的页面

### 时钟置换算法（CLOCK）

将内存中所有页面链接成一个循环队列，如果是1就置为0，如果是0就换出

![image-20260103214453681](/Users/miaowu/Library/Application Support/typora-user-images/image-20260103214453681.png)



# 文件

**文件的属性**：文件名，标识符，类型，位置，大小，创建时间，上次修改时间，文件所有者信息，保护信息

**有结构文件的逻辑结构**：顺序文件，索引文件，索引顺序文件，多级索引顺序文件

FCB的有序集合称为文件目录，一个FCB就是一个文件目录项。FCB包含了文件的基本信息，文件名，文件的物理地址的映射

![image-20260104162236985](/Users/miaowu/Library/Application Support/typora-user-images/image-20260104162236985.png)

**文件的物理结构**

### 文件的分配方式

连续分配：每个文件在磁盘上占有一组连续的块，支持顺序访问和直接访问（随机访问），在顺序读/写时速度最快，会产生磁盘碎片

链接分配：

1. 隐式链接：只支持顺序访问
2. 显示链接

**存储空间管理：**空闲表法，空闲链表法，位图示法，成组链接法

# I/O

I/O控制方式：程序直接控制方式（轮询），中断驱动方式，DMA方式，通道控制方式

![image-20260104185435487](/Users/miaowu/Library/Application Support/typora-user-images/image-20260104185435487.png)

## 小知识点

| **维度**     | **分时系统 (Time-sharing)**                                  | **实时系统 (Real-time)**                                     |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **设计目标** | **公平性**与**吞吐量**。尽量让所有用户都能分配到资源，提高资源利用率。 | **确定性**与**可靠性**。确保紧急任务在限定时间内必须完成。   |
| **交互性**   | **强**。主要服务于终端用户，能够处理复杂的交互请求。         | **弱**。通常与传感器、控制器交互，由特定的外部事件驱动。     |
| **响应时间** | 以**秒或毫秒**计。晚一点没关系，只是用户体验差（比如网页打开慢了点）。 | 以**微秒或毫秒**计。晚一点可能导致灾难（比如汽车安全气囊弹出晚了）。 |
| **任务调度** | **时间片轮转**。各任务优先级相对平等，轮流坐庄。             | **优先级驱动**。高优先级任务拥有抢占权（Preemption），可以立即打断当前运行的任务。 |
| **过载处理** | 性能逐渐下降（系统变慢）。                                   | 必须有严格的预测，过载时必须优先保证关键任务（如先救人，后保数据）。 |

多道运行：宏观上运行，微观上串行

操作系统的特征：并发，共享，虚拟，异步

| **维度**     | **同步通信**       | **异步通信**                 |
| ------------ | ------------------ | ---------------------------- |
| **等待行为** | 发送方阻塞等待     | 发送方不等待，继续工作       |
| **结果获取** | 直接通过返回值得知 | 通过回调、消息或信号告知     |
| **时序关系** | 串行执行，时序严格 | 并发执行，时序松散           |
| **典型场景** | 存钱取钱、函数调用 | 邮件发送、文件下载、Ajax请求 |
| **性能表现** | 响应及时但利用率低 | 吞吐量大但控制复杂           |
